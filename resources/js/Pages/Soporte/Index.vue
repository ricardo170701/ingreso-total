<template>
    <AppLayout>
        <div class="max-w-4xl mx-auto space-y-6">
            <div>
                <h1 class="text-xl font-semibold text-slate-900 dark:text-slate-100">
                    Centro de Soporte
                </h1>
                <p class="text-sm text-slate-600 dark:text-slate-400">
                    Encuentra respuestas a las preguntas m√°s frecuentes sobre el uso del sistema.
                </p>
            </div>

            <!-- Preguntas Frecuentes -->
            <div class="space-y-4">
                <!-- Pregunta 1: Registrar Usuarios -->
                <div
                    v-if="!esVisitante && hasAnyPermission(['view_users', 'create_users'])"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq1')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üë§</span>
                            <span>¬øC√≥mo registrar usuarios (enrollar)?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq1') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq1')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Para registrar un nuevo usuario en el sistema de control de accesos, sigue estos pasos:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede al m√≥dulo de Usuarios:</strong> Haz clic en "Usuarios" en el men√∫ lateral (requiere permisos <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">view_users</code> y <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">create_users</code>).
                            </li>
                            <li>
                                <strong>Crear nuevo usuario:</strong> Haz clic en el bot√≥n "Nuevo Usuario" o "Crear Usuario" en la parte superior de la lista.
                            </li>
                            <li>
                                <strong>Completa el formulario:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li><strong>Correo electr√≥nico:</strong> Direcci√≥n de correo √∫nica que servir√° como usuario de acceso</li>
                                    <li><strong>Contrase√±a:</strong> Establece una contrase√±a temporal (el usuario deber√° cambiarla en su primer acceso)</li>
                                    <li><strong>Datos personales:</strong> Nombre completo, apellido, n√∫mero de documento</li>
                                    <li><strong>Departamento:</strong> Selecciona el departamento al que pertenece (opcional)</li>
                                    <li><strong>Tipo de vinculaci√≥n:</strong> Selecciona entre:
                                        <ul class="list-circle list-inside ml-4 mt-1">
                                            <li><strong>Visitante:</strong> Acceso temporal y limitado</li>
                                            <li><strong>Servidor P√∫blico:</strong> Personal de la organizaci√≥n</li>
                                            <li><strong>Proveedor:</strong> Personal externo con acceso regular</li>
                                        </ul>
                                    </li>
                                    <li><strong>Cargo:</strong> Asigna un cargo para definir sus permisos de acceso a puertas y funciones del sistema</li>
                                    <li><strong>Fecha de expiraci√≥n:</strong> Configura si el acceso tiene fecha l√≠mite (opcional)</li>
                                    <li><strong>Activo:</strong> Marca esta opci√≥n para habilitar el acceso inmediatamente</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Guardar:</strong> Haz clic en "Guardar" o "Crear Usuario" para completar el registro.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>Nota importante:</strong> Debes proporcionarle manualmente el correo electr√≥nico y la contrase√±a temporal al usuario. En su primer acceso, el sistema le solicitar√° cambiar la contrase√±a por seguridad.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 2: Configurar Permisos -->
                <div
                    v-if="!esVisitante && hasPermission('view_cargos')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq2')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üîê</span>
                            <span>¬øC√≥mo configurar permisos?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq2') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq2')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Los permisos se configuran a trav√©s de los <strong>Cargos</strong>. Cada cargo define qu√© puede hacer un usuario en el sistema y a qu√© puertas f√≠sicas tiene acceso:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede al m√≥dulo de Cargos:</strong> Haz clic en "Cargos" o "Permisos" en el men√∫ lateral (requiere permiso <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">view_cargos</code>).
                            </li>
                            <li>
                                <strong>Selecciona o crea un cargo:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Si el cargo ya existe, haz clic en "Ver" o "Gestionar Permisos"</li>
                                    <li>Si necesitas crear uno nuevo, haz clic en "Nuevo Cargo" y completa el nombre y descripci√≥n</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Configura permisos del sistema (software):</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>En la secci√≥n <strong>"Permisos de la Sidebar"</strong>, marca los permisos que controlan qu√© botones del men√∫ puede ver el usuario (ej: ver usuarios, ver puertas, ver reportes)</li>
                                    <li>En las dem√°s secciones, marca los permisos de crear, editar, eliminar o gestionar seg√∫n corresponda</li>
                                    <li>Estos permisos determinan qu√© funciones del sistema web puede usar el usuario</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Configura permisos f√≠sicos (acceso a puertas):</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>En la secci√≥n "Agregar Permiso de Puerta", selecciona las puertas espec√≠ficas a las que tendr√° acceso</li>
                                    <li>Para cada puerta, configura:
                                        <ul class="list-circle list-inside ml-4 mt-1">
                                            <li><strong>Horarios:</strong> Hora de inicio y fin del acceso</li>
                                            <li><strong>D√≠as de la semana:</strong> Qu√© d√≠as es v√°lido el acceso</li>
                                            <li><strong>Fechas:</strong> Fecha de inicio y fin de validez (opcional)</li>
                                        </ul>
                                    </li>
                                    <li>Marca como activo para habilitar el acceso a esa puerta</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Asigna el cargo al usuario:</strong> Al crear o editar un usuario en el m√≥dulo de Usuarios, selecciona el cargo que acabas de configurar en el campo "Cargo".
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üí° Tip importante:</strong> Los permisos del sistema controlan qu√© secciones del men√∫ puede ver el usuario en la aplicaci√≥n web. Los permisos f√≠sicos (puertas) controlan a qu√© puertas f√≠sicas puede acceder con su QR o tarjeta NFC. <strong>Para funcionarios:</strong> Los permisos f√≠sicos del cargo se aplican autom√°ticamente al generar el QR - no necesitas configurarlos manualmente en el QR. <strong>Para visitantes:</strong> Los permisos se configuran expl√≠citamente al generar el QR seleccionando los pisos/puertas permitidos.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 3: Subir Mantenimiento -->
                <div
                    v-if="!esVisitante && hasAnyPermission(['view_mantenimientos', 'create_mantenimientos'])"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq3')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üîß</span>
                            <span>¬øC√≥mo subir un mantenimiento?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq3') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq3')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Para registrar un mantenimiento de una puerta de acceso, sigue estos pasos detallados:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede a una puerta:</strong> Ve al m√≥dulo <strong>Puertas</strong> en el men√∫ lateral y haz clic en <strong>"Ver Puerta"</strong> en la puerta que necesitas registrar.
                            </li>
                            <li>
                                <strong>Crear nuevo mantenimiento:</strong> En la secci√≥n "Hoja de Vida" o "Mantenimientos", haz clic en el bot√≥n <strong>"Nuevo Mantenimiento"</strong>.
                            </li>
                            <li>
                                <strong>Completa la informaci√≥n b√°sica:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>La <strong>puerta</strong> ya estar√° seleccionada autom√°ticamente</li>
                                    <li>Selecciona la <strong>fecha</strong> en que se realiz√≥ o se realizar√° el mantenimiento</li>
                                    <li>Elige el <strong>tipo</strong> de mantenimiento:
                                        <ul class="list-circle list-inside ml-4 mt-1">
                                            <li><strong>Realizado:</strong> Si el mantenimiento ya se complet√≥ (aparecer√° en el historial)</li>
                                            <li><strong>Programado:</strong> Si el mantenimiento est√° programado para el futuro (la puerta mostrar√° un indicador visual amarillo/rojo en el sistema)</li>
                                        </ul>
                                    </li>
                                    <li>Si es programado, indica la <strong>fecha de fin</strong> del per√≠odo de mantenimiento</li>
                                </ul>
                            </li>

                            <li>
                                <strong>Agrega informaci√≥n adicional:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>En <strong>"Descripci√≥n de mantenimiento"</strong> agrega notas detalladas sobre el mantenimiento, acciones realizadas, repuestos usados, etc.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Sube im√°genes de evidencia:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Haz clic en <strong>"Seleccionar Im√°genes"</strong> o arrastra archivos al √°rea designada</li>
                                    <li>Puedes subir hasta <strong>10 im√°genes</strong> por mantenimiento</li>
                                    <li>Cada imagen debe tener un <strong>m√°ximo de 2MB</strong></li>
                                    <li>Formatos aceptados: <strong>JPG, PNG o GIF</strong></li>
                                    <li>Las im√°genes sirven como evidencia fotogr√°fica del estado de la puerta</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Guardar:</strong> Haz clic en <strong>"Guardar"</strong> o <strong>"Crear Mantenimiento"</strong> para completar el registro. El mantenimiento quedar√° registrado en la hoja de vida de la puerta.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üìã Nota importante:</strong> Si registras un mantenimiento programado, la puerta mostrar√° un indicador amarillo en el sistema mientras est√© en per√≠odo de mantenimiento, y cambiar√° a rojo si pasa la fecha programada sin que se marque como realizado. Esto ayuda a identificar puertas que requieren atenci√≥n.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 4: Generar C√≥digos QR -->
                <div
                    v-if="esVisitante || hasPermission('view_ingreso')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq4')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üì±</span>
                            <span>¬øC√≥mo generar c√≥digos QR para acceso?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq4') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq4')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Para generar un c√≥digo QR que permita a un usuario acceder a las puertas del sistema, sigue estos pasos. <strong>Nota:</strong> Los visitantes NO pueden generar QR, solo pueden ver y descargar su QR activo si ya fue generado.
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede al m√≥dulo de Ingreso:</strong> Haz clic en <strong>"Ingreso"</strong> en el men√∫ lateral. Esta secci√≥n est√° disponible para todos los usuarios autenticados, pero solo usuarios con permisos pueden generar QR.
                            </li>
                            <li>
                                <strong>Selecciona el usuario:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Si tienes el permiso <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">create_ingreso_otros</code>, podr√°s seleccionar cualquier usuario del sistema</li>
                                    <li>Si no tienes ese permiso, solo podr√°s generar QR para ti mismo (el selector estar√° deshabilitado y mostrar√° tu nombre)</li>
                                    <li><strong>Importante:</strong> Los visitantes NO pueden generar QR. Solo pueden ver y descargar su QR activo si ya fue generado por un administrador. Los visitantes deben solicitar que un usuario con permisos les genere el QR.</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Configura el acceso:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li><strong>Para funcionarios (servidor p√∫blico/proveedor):</strong> Las puertas se asignan autom√°ticamente seg√∫n los permisos configurados en el cargo del usuario. No necesitas seleccionar puertas manualmente. El sistema usar√° los permisos f√≠sicos (puertas) que tiene configurados el cargo del usuario.</li>
                                    <li><strong>Para visitantes:</strong> Debes seleccionar los pisos (el sistema expandir√° autom√°ticamente a las puertas activas de esos pisos). Las puertas se guardan expl√≠citamente en el QR del visitante.</li>
                                    <li>Si el usuario es visitante sin correo, solo se puede asignar tarjeta NFC (no se genera QR)</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Configura horarios y fechas (opcional):</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li><strong>Fechas de validez:</strong> Fecha de inicio y fecha de fin del per√≠odo de validez del QR</li>
                                    <li>Si no configuras horarios, el acceso ser√° v√°lido las 24 horas del d√≠a</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Generar QR:</strong> Haz clic en el bot√≥n <strong>"Generar QR"</strong>. El sistema crear√° el c√≥digo y lo mostrar√° en pantalla.
                            </li>
                            <li>
                                <strong>Descargar o enviar:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Haz clic en <strong>"Descargar QR"</strong> para guardar la imagen en tu dispositivo</li>
                                    <li>Haz clic en <strong>"Enviar por Correo"</strong> para enviarlo directamente al correo del usuario (requiere que el usuario tenga correo configurado)</li>
                                         </ul>
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üì± Informaci√≥n importante:</strong> Para funcionarios, el QR permanece activo hasta la fecha de expiraci√≥n del usuario (si est√° configurada) o indefinidamente si tiene contrato indefinido. El acceso a puertas se eval√∫a autom√°ticamente seg√∫n los permisos del cargo del usuario en el momento de usar el QR. Para visitantes, el QR es v√°lido por defecto durante 1 d√≠a laborable, aunque puede configurarse para un per√≠odo mayor. Una vez vencido, el visitante necesitar√° solicitar que se le genere uno nuevo.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 5: Ver y Descargar PDF de Mantenimientos -->
                <div
                    v-if="!esVisitante && hasPermission('view_mantenimientos')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq5')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üìÑ</span>
                            <span>¬øC√≥mo ver y descargar el PDF de un mantenimiento?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq5') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq5')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Para ver los detalles de un mantenimiento y descargar su PDF en formato oficial:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede a una puerta:</strong> Ve al m√≥dulo <strong>Puertas</strong> en el men√∫ lateral y haz clic en <strong>"Ver Puerta"</strong> en la puerta que necesitas consultar.
                            </li>
                            <li>
                                <strong>Busca el mantenimiento:</strong> En la secci√≥n <strong>"Mantenimientos"</strong> o <strong>"Hoja de Vida"</strong>, localiza el registro del mantenimiento que deseas ver. Los mantenimientos est√°n ordenados por fecha (m√°s recientes primero).
                            </li>
                            <li>
                                <strong>Ver detalles:</strong> Haz clic en el mantenimiento en la lista o en el bot√≥n <strong>"Ver"</strong> para abrir la vista detallada completa.
                            </li>
                            <li>
                                <strong>Descargar PDF:</strong> En la vista de detalle del mantenimiento, localiza y haz clic en el bot√≥n <strong>"üìÑ Descargar PDF"</strong>. El archivo se generar√° y descargar√° autom√°ticamente.
                            </li>
                            <li>
                                <strong>Abrir el PDF:</strong> El archivo PDF se guardar√° en tu carpeta de descargas. Puedes abrirlo con cualquier lector de PDF (Adobe Reader, navegador, etc.) para verlo o imprimirlo.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üìÑ Contenido del PDF:</strong> El documento incluye informaci√≥n completa del equipo (puerta), datos del cliente/organizaci√≥n, evaluaci√≥n detallada de defectos con niveles de gravedad codificados por colores, observaciones del t√©cnico, referencias a evidencia fotogr√°fica adjunta, resultado de la inspecci√≥n y espacios designados para firmas de aprobaci√≥n.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 6: Exportar Reportes CSV -->
                <div
                    v-if="!esVisitante && hasPermission('view_reportes')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq6')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üìä</span>
                            <span>¬øC√≥mo exportar reportes en formato CSV?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq6') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq6')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Para exportar datos del sistema en formato CSV compatible con Excel y otras herramientas de an√°lisis:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede al m√≥dulo de Reportes:</strong> Haz clic en <strong>"Reportes"</strong> en el men√∫ lateral. Este m√≥dulo requiere el permiso <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">view_reportes</code>.
                            </li>
                            <li>
                                <strong>Selecciona el tipo de reporte:</strong> El sistema ofrece 4 tipos de reportes exportables:
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li><strong>Usuarios:</strong> Lista completa de usuarios con sus roles, cargos, departamentos, fechas de creaci√≥n y estado</li>
                                    <li><strong>Accesos:</strong> Historial completo de accesos a puertas con fecha, hora, usuario, puerta, tipo de evento (entrada/salida) y resultado</li>
                                    <li><strong>Mantenimientos:</strong> Registros de todos los mantenimientos realizados con fechas, t√©cnicos, defectos y observaciones</li>
                                    <li><strong>Puertas:</strong> Informaci√≥n t√©cnica de todas las puertas del sistema incluyendo c√≥digos, IPs, estados y ubicaciones</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Aplica filtros (opcional):</strong> Usa los campos de filtro disponibles para restringir los datos que deseas exportar:
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Filtros por fecha (rango de fechas)</li>
                                    <li>Filtros por usuario, puerta, departamento, etc.</li>
                                    <li>Filtros por estado (activo/inactivo)</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Exportar:</strong> Haz clic en el bot√≥n <strong>"üì• Exportar"</strong> correspondiente al tipo de reporte que deseas. El archivo CSV se generar√° con todos los datos visibles seg√∫n los filtros aplicados.
                            </li>
                            <li>
                                <strong>Abrir en Excel:</strong> El archivo CSV se descargar√° autom√°ticamente en tu carpeta de descargas. √Åbrelo con Microsoft Excel, Google Sheets o cualquier herramienta de hojas de c√°lculo para ver y analizar los datos formateados.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üî§ Compatibilidad de caracteres:</strong> Los archivos CSV est√°n codificados en UTF-8 con BOM (Byte Order Mark), por lo que los caracteres especiales (√°, √©, √≠, √≥, √∫, √±, etc.) se ver√°n correctamente en Excel. Si al abrir el archivo no se ven bien los caracteres especiales, en Excel selecciona "Datos" ‚Üí "Obtener datos" ‚Üí "Desde texto/CSV" y elige "65001: Unicode (UTF-8)" como codificaci√≥n de origen.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 7: Gestionar Departamentos -->
                <div
                    v-if="!esVisitante && hasPermission('view_departamentos')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq7')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üè¢</span>
                            <span>¬øC√≥mo gestionar departamentos?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq7') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq7')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Los departamentos organizan a los usuarios por √°rea o dependencia dentro de la organizaci√≥n, facilitando la gesti√≥n y los reportes:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede al m√≥dulo de Departamentos:</strong> Haz clic en <strong>"Departamentos"</strong> en el men√∫ lateral. Este m√≥dulo requiere el permiso <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">view_departamentos</code>.
                            </li>
                            <li>
                                <strong>Crear nuevo departamento:</strong> Haz clic en el bot√≥n <strong>"Nuevo Departamento"</strong> y completa el formulario:
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li><strong>Nombre:</strong> Nombre descriptivo del departamento (ej: "Recursos Humanos", "Tecnolog√≠a", "Administraci√≥n")</li>
                                    <li><strong>Piso:</strong> Piso o nivel donde se encuentra f√≠sicamente el departamento (opcional, √∫til para organizar por ubicaci√≥n)</li>
                                    <li><strong>Descripci√≥n:</strong> Informaci√≥n adicional sobre el departamento, su funci√≥n o responsabilidades</li>
                                    <li><strong>Activo:</strong> Marca esta opci√≥n si el departamento est√° actualmente activo en la organizaci√≥n</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Asignar a usuarios:</strong> Al crear o editar un usuario en el m√≥dulo de Usuarios, selecciona el departamento correspondiente en el campo <strong>"Departamento"</strong>. Cada usuario puede pertenecer a un solo departamento.
                            </li>
                            <li>
                                <strong>Gestionar departamentos existentes:</strong> Puedes editar o desactivar departamentos existentes desde la lista. Los departamentos desactivados no aparecer√°n en los selectores al crear nuevos usuarios.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üí° Tip √∫til:</strong> Los departamentos son muy √∫tiles para organizar reportes, filtrar usuarios en listados y generar estad√≠sticas por √°rea. Un usuario solo puede pertenecer a un departamento a la vez. Los departamentos tambi√©n pueden estar organizados dentro de Secretar√≠as y Gerencias para una estructura jer√°rquica m√°s compleja.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 8: Protocolo de Emergencia -->
                <div
                    v-if="!esVisitante && hasPermission('view_protocolo')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq8')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üö®</span>
                            <span>¬øC√≥mo usar el Protocolo de Emergencia?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq8') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq8')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            El Protocolo de Emergencia permite abrir todas las puertas del sistema simult√°neamente en caso de emergencia real, facilitando la evacuaci√≥n o acceso de emergencia:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Requisito de permiso:</strong> Necesitas el permiso especial <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">protocol_emergencia_open_all</code> para ejecutar el protocolo. Este permiso est√° restringido por seguridad.
                            </li>
                            <li>
                                <strong>Accede al m√≥dulo de Protocolo:</strong> Haz clic en <strong>"Protocolo"</strong> en el men√∫ lateral (√≠cono üö®). Este m√≥dulo requiere el permiso <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">view_protocolo</code>.
                            </li>
                            <li>
                                <strong>Revisa las puertas activas:</strong> El sistema mostrar√° todas las puertas activas con sus IPs configuradas, estado de conexi√≥n y √∫ltima comunicaci√≥n. Verifica que las puertas cr√≠ticas est√©n en l√≠nea antes de activar.
                            </li>
                            <li>
                                <strong>Activar protocolo:</strong> Haz clic en el bot√≥n <strong>"Activar Protocolo de Emergencia"</strong>. El sistema te pedir√° confirmaci√≥n antes de ejecutar.
                            </li>
                            <li>
                                <strong>Confirmar y monitorear:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>El sistema abrir√° todas las puertas en paralelo mediante comunicaci√≥n simult√°nea con cada dispositivo</li>
                                    <li>Las puertas se mantendr√°n abiertas durante 15 minutos por defecto (tiempo configurable)</li>
                                    <li>Ver√°s en tiempo real cu√°ntas puertas se abrieron exitosamente y cu√°les fallaron</li>
                                    <li>Puedes desactivar el protocolo manualmente antes de que expire el tiempo</li>
                                </ul>
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-yellow-800 dark:text-yellow-300">
                                <strong>‚ö†Ô∏è ADVERTENCIA CR√çTICA:</strong> Esta acci√≥n se registra permanentemente en el historial con tu usuario y timestamp. Las puertas se mantendr√°n abiertas incluso si se corta la conexi√≥n de red (el comando se ejecuta localmente en cada dispositivo). Solo usar en casos de emergencia real (incendio, evacuaci√≥n, emergencia m√©dica, etc.). El uso indebido puede comprometer la seguridad del edificio.
                            </p>
                        </div>
                        <div class="mt-3 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üìã Historial y auditor√≠a:</strong> Puedes ver las √∫ltimas ejecuciones del protocolo en la tabla inferior del m√≥dulo, incluyendo qui√©n lo ejecut√≥, fecha y hora exacta, cu√°ntas puertas se abrieron exitosamente, cu√°les fallaron (y por qu√©), y el tiempo de duraci√≥n. Esta informaci√≥n es importante para auditor√≠as de seguridad.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 9: Cambio de Contrase√±a -->
                <div
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq9')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üîë</span>
                            <span>¬øC√≥mo cambiar mi contrase√±a?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq9') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq9')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Si es la primera vez que ingresas al sistema o necesitas cambiar tu contrase√±a:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Primera vez:</strong> Si es tu primer acceso, el sistema te redirigir√° autom√°ticamente a la pantalla de cambio de contrase√±a despu√©s de iniciar sesi√≥n.
                            </li>
                            <li>
                                <strong>Cambio posterior:</strong> Puedes cambiar tu contrase√±a desde tu perfil:
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Haz clic en tu nombre en la esquina superior derecha</li>
                                    <li>Selecciona "Perfil"</li>
                                    <li>En la secci√≥n de contrase√±a, ingresa tu contrase√±a actual y la nueva contrase√±a</li>
                                    <li>Confirma la nueva contrase√±a y guarda los cambios</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Requisitos de contrase√±a:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>M√≠nimo 8 caracteres</li>
                                    <li>Se recomienda usar una combinaci√≥n de letras, n√∫meros y caracteres especiales</li>
                                </ul>
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>Nota para visitantes:</strong> Despu√©s de cambiar tu contrase√±a por primera vez, ser√°s redirigido autom√°ticamente a la secci√≥n de Ingreso. Si ya tienes un QR activo, podr√°s verlo y descargarlo. Si no tienes QR, deber√°s solicitar a un administrador que te genere uno.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 10: Recuperar Contrase√±a -->
                <div
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq10')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üîì</span>
                            <span>¬øQu√© hacer si olvid√© mi contrase√±a?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq10') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq10')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Si olvidaste tu contrase√±a, puedes recuperarla siguiendo estos pasos:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede a la pantalla de login:</strong> En la p√°gina de inicio de sesi√≥n, haz clic en "¬øOlvidaste tu contrase√±a?" o "Recuperar contrase√±a".
                            </li>
                            <li>
                                <strong>Ingresa tu correo:</strong> Proporciona el correo electr√≥nico asociado a tu cuenta.
                            </li>
                            <li>
                                <strong>Revisa tu correo:</strong> Recibir√°s un enlace de recuperaci√≥n en tu bandeja de entrada (revisa tambi√©n la carpeta de spam).
                            </li>
                            <li>
                                <strong>Restablece tu contrase√±a:</strong> Haz clic en el enlace del correo y sigue las instrucciones para crear una nueva contrase√±a.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-yellow-800 dark:text-yellow-300">
                                <strong>‚ö†Ô∏è Importante:</strong> El enlace de recuperaci√≥n tiene un tiempo limitado de validez. Si no recibes el correo, verifica que tu direcci√≥n de correo est√© correcta en el sistema o contacta al administrador.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 11: Tarjetas NFC -->
                <div
                    v-if="!esVisitante && hasPermission('view_tarjetas_nfc')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq11')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üí≥</span>
                            <span>¬øC√≥mo gestionar tarjetas NFC?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq11') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq11')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Las tarjetas NFC son una alternativa f√≠sica a los c√≥digos QR para acceder a las puertas:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede al m√≥dulo de Tarjetas NFC:</strong> Haz clic en "Tarjetas NFC" en el men√∫ lateral (requiere permiso <code class="bg-slate-100 dark:bg-slate-700 px-1 py-0.5 rounded text-slate-900 dark:text-slate-100 transition-colors duration-200">view_tarjetas_nfc</code>).
                            </li>
                            <li>
                                <strong>Registrar una nueva tarjeta:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Haz clic en "Nueva Tarjeta"</li>
                                    <li>Ingresa el c√≥digo de la tarjeta NFC (se obtiene al acercar la tarjeta al lector)</li>
                                    <li>Asigna un nombre descriptivo para identificar la tarjeta</li>
                                    <li>Marca como activa si est√° en uso</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Asignar tarjeta a un usuario:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Desde el m√≥dulo de Ingreso, selecciona el usuario</li>
                                    <li>Haz clic en "Asignar Tarjeta NFC"</li>
                                    <li>Selecciona la tarjeta disponible y confirma</li>
                                    <li>Configura las puertas y horarios de acceso (similar a los QR)</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Desasignar tarjeta:</strong> Puedes desasignar una tarjeta desde el m√≥dulo de Ingreso o desde Tarjetas NFC cuando ya no se necesite.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>Ventajas de las tarjetas NFC:</strong> Son m√°s r√°pidas y convenientes que los QR, especialmente para acceso frecuente. Funcionan igual que los QR en t√©rminos de permisos y horarios configurados.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 12: Problemas de Acceso -->
                <div
                    v-if="esVisitante || hasPermission('view_ingreso')"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq12')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>‚ùå</span>
                            <span>¬øPor qu√© mi QR o tarjeta NFC no funciona?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq12') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq12')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Si tu QR o tarjeta NFC no est√° funcionando, verifica estos puntos:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>QR/Tarjeta activa:</strong> Verifica que tu QR o tarjeta est√© marcada como activa en el sistema.
                            </li>
                            <li>
                                <strong>Fecha de expiraci√≥n:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Para visitantes: verifica que el QR no haya expirado (por defecto duran 1 d√≠a laborable)</li>
                                    <li>Para funcionarios: verifica que tu cuenta de usuario no haya expirado</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Permisos de puerta:</strong> Aseg√∫rate de que tu QR o tarjeta tenga permisos configurados para la puerta que intentas abrir.
                            </li>
                            <li>
                                <strong>Horarios:</strong> Verifica que est√©s intentando acceder dentro del horario configurado para tu QR o tarjeta.
                            </li>
                            <li>
                                <strong>Usuario activo:</strong> Tu cuenta de usuario debe estar marcada como activa en el sistema.
                            </li>
                            <li>
                                <strong>Calidad del QR:</strong> Si usas QR, aseg√∫rate de que la imagen est√© n√≠tida y completa en tu dispositivo. Intenta aumentar el brillo de la pantalla.
                            </li>
                            <li>
                                <strong>Distancia del lector:</strong> Para tarjetas NFC, ac√©rcate lo suficiente al lector (generalmente 2-5 cm).
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-yellow-800 dark:text-yellow-300">
                                <strong>üí° Soluci√≥n r√°pida:</strong> Si eres visitante y tu QR expir√≥, debes solicitar a un administrador o personal autorizado que te genere uno nuevo, ya que los visitantes no pueden generar QR por s√≠ mismos. Si eres funcionario y tu QR no funciona, verifica que tu cuenta est√© activa y que tengas permisos en tu cargo para acceder a esa puerta. Si el problema persiste, contacta al administrador del sistema.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 13: Mantenimientos de UPS -->
                <div
                    v-if="!esVisitante && hasAnyPermission(['view_ups', 'create_mantenimientos'])"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq13')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üîã</span>
                            <span>¬øC√≥mo registrar mantenimientos de UPS?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq13') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq13')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Para registrar un mantenimiento de un equipo UPS:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Accede al m√≥dulo de UPS:</strong> Haz clic en "UPS" en el men√∫ lateral.
                            </li>
                            <li>
                                <strong>Selecciona el UPS:</strong> Haz clic en "Ver" en el UPS al que se le realiz√≥ el mantenimiento.
                            </li>
                            <li>
                                <strong>Crear nuevo mantenimiento:</strong> En la secci√≥n de mantenimientos, haz clic en "Nuevo Mantenimiento".
                            </li>
                            <li>
                                <strong>Completa el formulario:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Selecciona la fecha del mantenimiento</li>
                                    <li>Elige el tipo: Realizado o Programado</li>
                                    <li>Si es programado, indica la fecha de fin</li>
                                    <li>Completa los indicadores t√©cnicos (voltaje, temperatura, etc.)</li>
                                    <li>Agrega observaciones sobre el mantenimiento</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Sube evidencia:</strong> Puedes subir im√°genes de la bit√°cora f√≠sica o documentos relacionados.
                            </li>
                            <li>
                                <strong>Guardar:</strong> Haz clic en "Guardar" para completar el registro.
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>Nota:</strong> Los mantenimientos de UPS tambi√©n pueden incluir an√°lisis de im√°genes de bit√°coras f√≠sicas usando la funci√≥n de an√°lisis de im√°genes en la secci√≥n de Bit√°cora.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Pregunta 14: Uso del QR como Visitante -->
                <div
                    v-if="esVisitante"
                    class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden transition-colors duration-200"
                >
                    <button
                        @click="toggleFAQ('faq14')"
                        class="w-full text-left p-6 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors duration-200"
                    >
                        <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center gap-2">
                            <span>üëã</span>
                            <span>¬øC√≥mo usar mi QR como visitante?</span>
                        </h2>
                        <svg
                            class="w-5 h-5 text-slate-500 dark:text-slate-400 transition-transform duration-200"
                            :class="{ 'rotate-180': isOpen('faq14') }"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div
                        v-show="isOpen('faq14')"
                        class="px-6 pb-6 space-y-3 text-sm text-slate-700 dark:text-slate-300 transition-all"
                    >
                        <p>
                            Como visitante, tu acceso al sistema est√° limitado a ver y usar tu c√≥digo QR. <strong>No puedes generar QR por ti mismo</strong>:
                        </p>
                        <ol class="list-decimal list-inside space-y-2 ml-2">
                            <li>
                                <strong>Solicitar tu QR:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Debes solicitar a un usuario con permisos (administrador o personal autorizado) que genere tu c√≥digo QR</li>
                                    <li>El administrador configurar√° las puertas, pisos y horarios de acceso seg√∫n tu autorizaci√≥n</li>
                                    <li>Una vez generado, podr√°s ver y descargar tu QR desde la secci√≥n de Ingreso</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Ver y descargar tu QR:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Despu√©s de iniciar sesi√≥n, ser√°s redirigido autom√°ticamente a la secci√≥n de Ingreso</li>
                                    <li>Si ya tienes un QR activo, lo ver√°s en pantalla</li>
                                    <li>Haz clic en "Descargar QR" para guardar la imagen en tu dispositivo m√≥vil</li>
                                    <li>Tambi√©n puedes usar "Enviar por Correo" para recibirlo en tu correo electr√≥nico</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Usar tu QR:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Guarda el QR descargado en tu dispositivo m√≥vil (galer√≠a de fotos)</li>
                                    <li>Al llegar a una puerta, abre la imagen del QR en tu tel√©fono</li>
                                    <li>Acerca el QR al lector de la puerta</li>
                                    <li>El lector escanear√° el c√≥digo y abrir√° la puerta si tienes permiso y est√°s dentro del horario configurado</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Validez del QR:</strong>
                                <ul class="list-disc list-inside ml-4 mt-1 space-y-1">
                                    <li>Por defecto, tu QR es v√°lido por 1 d√≠a laborable desde su generaci√≥n</li>
                                    <li>Una vez expirado, necesitar√°s solicitar a un administrador que genere uno nuevo</li>
                                    <li>Puedes verificar la fecha de expiraci√≥n en la secci√≥n de Ingreso</li>
                                </ul>
                            </li>
                        </ol>
                        <div class="mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-yellow-800 dark:text-yellow-300">
                                <strong>‚ö†Ô∏è Importante:</strong> Como visitante, no puedes generar QR por ti mismo. Si necesitas un nuevo QR o tu QR ha expirado, debes contactar a un administrador o personal autorizado para que te lo genere.
                            </p>
                        </div>
                        <div class="mt-3 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg transition-colors duration-200">
                            <p class="text-xs text-blue-800 dark:text-blue-300">
                                <strong>üí° Tip:</strong> Guarda el QR en tu galer√≠a de fotos para acceso r√°pido. Aseg√∫rate de que la imagen est√© n√≠tida y completa para que el lector pueda escanearla correctamente. Mant√©n el brillo de la pantalla alto al acercar el QR al lector.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </AppLayout>
</template>

<script setup>
import { ref, computed, onMounted } from "vue";
import { usePage } from "@inertiajs/vue3";
import AppLayout from "@/Layouts/AppLayout.vue";

const page = usePage();

// Estado para controlar qu√© FAQs est√°n abiertas
const openFAQs = ref({});

// Obtener permisos del usuario
const userPermissions = computed(() => page.props.auth?.user?.permissions || []);
const esVisitante = computed(() => page.props.auth?.user?.role?.name === "visitante");

// Funci√≥n para verificar si el usuario tiene un permiso
const hasPermission = (permission) => {
    return userPermissions.value.includes(permission);
};

// Funci√≥n para verificar si el usuario tiene alguno de los permisos
const hasAnyPermission = (permissions) => {
    return permissions.some(perm => userPermissions.value.includes(perm));
};

const toggleFAQ = (faqId) => {
    openFAQs.value[faqId] = !openFAQs.value[faqId];
};

const isOpen = (faqId) => {
    return openFAQs.value[faqId] || false;
};

// Visitante: abrir autom√°ticamente la gu√≠a de QR
onMounted(() => {
    if (esVisitante.value) {
        openFAQs.value = { faq4: true };
    }
});
</script>

